{{ define "modules/index/html/miniapp" }}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>My Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            background: #f9f9f9;
            text-align: center;
            padding: 50px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 8px;
            border: none;
            background: #0088cc;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
<h1>ðŸš€ Telegram Mini App</h1>
<p>Welcome, <span id="username"></span></p>
<button id="send">Send Data to Backend</button>

<script>
    const tg = window.Telegram.WebApp;

    // Expand the app to full screen
    tg.expand();

    // Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±
    document.getElementById("username").textContent = tg.initDataUnsafe?.user?.first_name || "Guest";

    // Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„
    document.getElementById("send").addEventListener("click", async () => {
        const data = {
            user: tg.initDataUnsafe?.user,
            message: "Hello from Mini App!",
        };

        try {
            const res = await fetch("https://abler-carmela-pliant.ngrok-free.dev/callback", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            });

            const result = await res.json();
            alert("Server response: " + JSON.stringify(result));
        } catch (err) {
            alert("Error: " + err);
        }
    });
</script>
</body>
</html>
{{ end }}